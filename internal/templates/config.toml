# Everyday setup:
# - Use `al wizard` for most changes.
# - Usually you only need to toggle agent/server `enabled` values.
# - Leave advanced fields as-is unless you have a specific need.

[approvals]
# one of: "all", "mcp", "commands", "none", "yolo"
# yolo skips ALL permission prompts; use only in sandboxed/ephemeral environments
mode = "all"

[agents.gemini]
enabled = true
# model is optional; when omitted, Agent Layer does not pass a model flag and the client uses its default.
# model = "..."
# reasoning_effort is not currently supported for Gemini in Agent Layer.

[agents.claude]
enabled = true
# model is optional; when omitted, Agent Layer does not pass a model flag and the client uses its default.
# model = "..."
# reasoning_effort is optional for Opus models only.
# reasoning_effort = "medium" # low | medium | high
# local_config_dir isolates Claude Code settings and caches per repo.
# When true, al claude sets CLAUDE_CONFIG_DIR=<repo>/.claude-config.
# For al vscode, CLAUDE_CONFIG_DIR is set when both this and agents.claude-vscode
# are enabled. Otherwise, al vscode clears only stale repo-local values and
# preserves user-defined non-repo values.
# Note: auth credentials are stored globally by Claude Code in the OS credential store
# (macOS Keychain service "Claude Code-credentials"; Linux libsecret/gnome-keyring)
# regardless of this setting (upstream limitation).
# local_config_dir = false
# Optional agent-specific passthrough config for Claude (arbitrary JSON keys).
# These are shallow-merged at the top level into .claude/settings.json.
# Nested objects are replaced (not deep-merged).
# Overlapping keys override Agent Layer-managed values and trigger a sync warning.
# [agents.claude.agent_specific]

[agents.claude-vscode]
enabled = true

[agents.codex]
enabled = true
# model is optional; when omitted, Agent Layer does not pass a model setting and the client uses its default.
# model = "gpt-5.3-codex"
# reasoning_effort is optional; when omitted, the client uses its default.
# reasoning_effort = "xhigh" # codex only
# Optional agent-specific passthrough config for Codex (arbitrary TOML tables/keys).
# These are appended to .codex/config.toml and can override top-level managed keys.
# Overlapping keys override Agent Layer-managed values and trigger a sync warning.
# [agents.codex.agent_specific]
# [agents.codex.agent_specific.features]
# multi_agent = true
# prevent_idle_sleep = true

[agents.vscode]
enabled = true

[agents.antigravity]
enabled = true

[mcp]
# Secrets belong in .agent-layer/.env (never in config.toml).
# These are optional external MCP servers projected into client configs.
# Most teams only enable the few they actively use.

[[mcp.servers]]
# Context7 docs/code lookup (requires AL_CONTEXT7_API_KEY).
id = "context7"
enabled = false
transport = "stdio"
command = "npx"
args = ["-y", "@upstash/context7-mcp@2.1.1"]
# Opt in to floating updates:
# args = ["-y", "@upstash/context7-mcp@latest"]
env = { CONTEXT7_API_KEY = "${AL_CONTEXT7_API_KEY}" }

[[mcp.servers]]
# Tavily web search/research (requires AL_TAVILY_API_KEY).
id = "tavily"
enabled = false
transport = "http"
http_transport = "streamable"
url = "https://mcp.tavily.com/mcp/?tavilyApiKey=${AL_TAVILY_API_KEY}"

[[mcp.servers]]
# Fetch URL contents (requires `uvx`).
id = "fetch"
enabled = false
transport = "stdio"
command = "uvx"
args = ["mcp-server-fetch==2025.4.7"]
# Opt in to floating updates:
# args = ["mcp-server-fetch"]

[[mcp.servers]]
# Playwright browser automation (requires Node/npx).
id = "playwright"
enabled = false
transport = "stdio"
command = "npx"
args = ["-y", "@playwright/mcp@0.0.68"]
# Opt in to floating updates:
# args = ["-y", "@playwright/mcp@latest"]

[[mcp.servers]]
# Ripgrep fast repo search (requires Node/npx).
id = "ripgrep"
enabled = false
clients = ["gemini", "claude", "codex"]
transport = "stdio"
command = "npx"
args = ["-y", "mcp-ripgrep@0.4.0"]
# Opt in to floating updates:
# args = ["-y", "mcp-ripgrep@latest"]

[[mcp.servers]]
# Filesystem access scoped to this repo (requires Node/npx).
id = "filesystem"
enabled = false
clients = ["gemini", "claude", "codex"]
transport = "stdio"
command = "npx"
# Restrict access to the current repo; paths may be absolute or relative.
# Use ${AL_REPO_ROOT} (or ~/...) to expand to an absolute path when run.
args = ["-y", "@modelcontextprotocol/server-filesystem@2026.1.14", "${AL_REPO_ROOT}"]
# Opt in to floating updates:
# args = ["-y", "@modelcontextprotocol/server-filesystem@latest", "${AL_REPO_ROOT}"]

[warnings]
# Optional warning defaults.
# Wizard now uses these defaults directly when warnings are enabled.
version_update_on_sync = true
# warning noise mode: default | reduce | quiet
# quiet suppresses agent-layer informational output (warnings, update checks, dispatch banners),
# but does not affect `al doctor` (doctor always prints warnings).
noise_mode = "default"
instruction_token_threshold = 10000
mcp_server_threshold = 15
mcp_tools_total_threshold = 60
mcp_server_tools_threshold = 25
mcp_schema_tokens_total_threshold = 30000
mcp_schema_tokens_server_threshold = 20000

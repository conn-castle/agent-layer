---
title: Single source of truth
---

Agent Layer centralizes instructions, slash commands, approvals, and MCP server configuration under `.agent-layer/`, then projects them into each client's native format.

This matters because every client expects different config files and conventions. If you edit those files directly, they drift and you lose consistency across tools.

## What is canonical

The canonical inputs live in `.agent-layer/`:

- `config.toml` for structured configuration
- `instructions/` for agent rules and guidance
- `slash-commands/` for repeatable workflows
- `commands.allow` for approved shell command prefixes
- `.env` for secrets

Everything else is derived output and can be overwritten at any time.

## What gets generated

When you run `al sync` or `al <client>`, Agent Layer generates client-specific config files and launchers, such as:

- `.gemini/`, `.claude/`, `.codex/`, `.vscode/`
- `.mcp.json`
- `AGENTS.md`

The generated files are always safe to delete and regenerate.

## Why this prevents drift

In a manual setup, every client becomes a separate source of truth. You change a rule in one place and forget to update another. That is how approvals diverge, MCP servers go missing, and agents behave inconsistently.

Agent Layer avoids that by forcing everything through a single canonical input. The outputs are always derived and always disposable.

## Anti-patterns to avoid

- Editing files under `.gemini/`, `.claude/`, `.codex/`, or `.vscode/`
- Copying instructions manually between clients
- Maintaining separate MCP configs for each agent
- Treating generated files as source of truth

If you see drift, move the change into `.agent-layer/` and regenerate.

:::note
If you need to inspect generated output for debugging, open it read-only. Then move the fix back into `.agent-layer/`.
:::

## Recommended workflow

- Edit `.agent-layer/` only.
- Treat generated files as build artifacts.
- Use `al sync` before running a client if you want a clean regenerate without launch.

## When you might commit generated files

Most teams should not commit generated client configs. The only common exception is when a client requires a repo-local file and you want onboarding to be one command.

If you commit generated files, document that decision and make sure it is enforced consistently across the team.
